---
layout: post
title: Renderer
categories: django
tags: drf
---

### ğŸ’¡ ***Renderer***

Rendererë¥¼ ê°™ì€ Endpointì— ëŒ€í•´ì„œ ë™ì¼í•œ ë¡œì§ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬ í•˜ê³  ë‚˜ì„œ 

ìµœì¢…ì ìœ¼ë¡œ ì‘ë‹µì„ ì¤„ ë•Œì— ì–´ë–¤ ì‘ë‹µ í¬ë§·ìœ¼ë¡œ ì²˜ë¦¬í•  ê²ƒì¸ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.

Content-Type, URLì˜ ë°©ë²•ì„ í†µí•´ì„œ Renderer ì§€ì • ê°€ëŠ¥í•˜ë‹¤.

---

<br>

### ğŸ’¡ ***ê¸°ë³¸ ì§€ì› ë˜ëŠ” Renderer***

#### 1. JSONRenderer (default ì§€ì •)

â–ª media_type â†’ application/json â†’ json

json.dumpsë¥¼ í†µí•œ JSON ì§ë ¬í™”

<br>

#### 2. BrowsableAPIRenderer (default ì§€ì •)

â–ª media_type â†’ text/html, format â†’ api

self-document HTML ë Œë”ë§

<br>

#### 3. Template(HTML)Renderer 

â–ª media_type â†’ text/html, format â†’ api

ì§€ì • í…œí”Œë¦¿ì„ í†µí•œ ë Œë”ë§

Responseì—ì„œ template_name ì¸ì ì§€ì • í•„ìš”

API ì„œë²„ë¼ê³  í•´ì„œ ëª¨ë“  ì‘ë‹µì„ JSONìœ¼ë¡œ ë°›ì§€ ì•Šì•„ë„, ê²½ìš°ì— ë”°ë¼ì„œ HTMLì‘ë‹µì„ ë°›ì„ ìˆ˜ë„ ìˆë‹¤.

<br>

```python
class PostDetailAPIView(RetrieveAPIView):
    queryset = Post.objects.all()
    renderer_template = [TemplateHTMLRender]
    template_name = 'instagram/post_detail.html'

    """
    template_nameì€ ì—¬ê¸°ì— ì„ ì–¸í•´ë„ ë˜ê³ ,

    ë˜ëŠ” getí•¨ìˆ˜ì˜ kwargsë¡œ ë„˜ê²¨ë„ ìƒê´€ì—†ë‹¤.
    """

    def get(self, request, *args, **kwargs):
        post = self.get_object()

        return Response({
            'post':PostSerializer(post).data
        })
```
ìœ„ ì½”ë“œì—ì„œ <span style="color:#9932CC">**get_object()**</span>ëŠ” <span style="color:#B8860B">**RetrieveAPIView**</span> í´ë˜ìŠ¤ ë‚´ë¶€ì— êµ¬í˜„ë˜ì–´ ìˆë‹¤.

ê·¸ë¦¬ê³  kwargsì—ì„œ 'post':PostSerializer(post).data ê°™ì´ ë„˜ê²¨ì£¼ê²Œ ë˜ë©´ 

ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•´ì¤€ë‹¤.

<img src="/assets/img/django/renderer1.png">

ë°˜ë©´ì— ê·¸ëƒ¥ postë§Œ ë„˜ê²¨ì£¼ê²Œ ëœë‹¤ë©´, ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.

<img src="/assets/img/django/renderer2.png">

---

<br>

### ğŸ’¡ ***ë‹¤ì–‘í•œ Renderer***

#### StaticRenderer

ë¯¸ë¦¬ ë Œë”ë§ëœ HTMLì„ ë°˜í™˜í•œë‹¤. 

ì•„ë˜ì™€ ê°™ì´, Responseê°ì²´ ìƒì„±ì‹œì— HTMLë¬¸ìì—´ì„ ì§ì ‘ ì§€ì •í•´ ì¤€ë‹¤.

```python
@api_view(['GET'])
@renderer_classes([StaicHTMLRenderer])
def static_view(request):
    html = """<html><body>example</body><html>"""
    return Response(html)
```
ì´ ì™¸ì—ë„ AdminRenderer, HTMLFormRenderer, MultiPartRendererë“±ì´ ì§€ì›ëœë‹¤.

---

<br>

### ğŸ’¡ ***Renderer í´ë˜ìŠ¤ ë¦¬ìŠ¤íŠ¸ ì§€ì •í•˜ê¸°***

<br>

#### 1. ì „ì—­ ì§€ì • (ì¶”ì²œ âœ”)

settings > REST_FRAMEWORK > <span style="color:#B8860B">**DEFAULT_RENDERER_CLASSES ë¦¬ìŠ¤íŠ¸**</span>ì— ë¬¸ìì—´ë¡œ ì§€ì •.

â–ª [rest_framework/settings.py](https://github.com/Gilbert9172/django-rest-framework/blob/master/rest_framework/settings.py)

<br>

#### 2. APIView ë§ˆë‹¤ ì§€ì •

queryset, serializer_classì™€ ë”ë¶ˆì–´, renderer_classes ë¦¬ìŠ¤íŠ¸ 

<br>

#### 3. @api_view ë§ˆë‹¤ ì§€ì •

ë³„ë„ì˜ renderer_classes ì¥ì‹ìê°€ ìˆë‹¤.

---

<br>

### ğŸ’¡ ***Renderer ì‘ë‹µ í¬ë§·***

<br>

#### 1. ë‘ ê°€ì§€ ìœ í˜•ì˜ ì‘ë‹µ í¬ë§·

â–ª api : API EndPointì— ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ ì ‘ê·¼í•  ë•Œ, ì›¹ UIë¡œ ì¡°íšŒ ê°€ëŠ¥

    http://127.0.0.1:8000/post/1.api

    http://127.0.0.1:8000/post/1/?format=api

â–ª json : ë³´í†µì˜ APIì ‘ê·¼

    http://127.0.0.1:8000/post/1.json

    http://127.0.0.1:8000/post/1/?format=json

<br>

#### 2. ì‘ë‹µ í¬ë§·ì€ ì–´ë–»ê²Œ ê²°ì •ë˜ëŠ”ê°€?

***Accept í—¤ë”***

â€¢ Accept: application/json

â€¢ Accept: text/html

<br>


***GETì¸ì format***

â€¢ ?format=json

â€¢ ?format=api

<br>


***URL Captured Valuesì—ì„œì˜ format ì¸ì***

â€¢ .json

â€¢ .api

---

<br>

### ğŸ’¡ ***URL Captured Valuesì—ì„œì˜ format ì¸ì***

routerë¥¼ ì‚¬ìš©í•  ê²½ìš° ì•„ë˜ì™€ ê°™ì´ format ì¸ìë¥¼ ê¸°ë³¸ì ìœ¼ë¡œ ì§€ì›í•´ì¤€ë‹¤.
```txt
<URLPattern '^post\.(?P<format>[a-z0-9]+)/?$' [name='post-list']>
```

<br>

ë°˜ë©´ì— ê°œë°œìê°€ "í•¨ìˆ˜ê¸°ë°˜ view"ë¥¼ êµ¬í˜„í•  ê²½ìš°ì—ëŠ” í•„íˆ URLPatternsì— ì§€ì •ëœ 

**`format=None`**ì„ kwargsë¡œ ë„˜ê²¨ì¤˜ì•¼í•œë‹¤. 

> "í´ë˜ìŠ¤ ê¸°ë°˜ view"ëŠ” í¬ê²Œ ë¬¸ì œê°€ ë˜ëŠ” ë¶€ë¶„ì´ ì—†ë‹¤.

Noneìœ¼ë¡œ ë„˜ê²¨ì£¼ëŠ” ì´ìœ ëŠ” formatì´ ì—†ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ defaultê°’ì„ ì§€ì •í•´ ì£¼ëŠ” ê²ƒì´ë‹¤.

```python
# views.py
from rest_framework.decorators import api_view

@api_view(['GET'])
def hello(request, format=None):
    return Response([])
```

ì•„ë˜ ì½”ë“œëŠ” ê·¸ë¦¬ê³  routerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , format ì¸ìë¥¼ URLPatternsì— ì„ ì–¸í•˜ëŠ” ë°©ë²•ì´ë‹¤. 

```python
# urls.py
from rest_framework.url.patterns import format_surfix_patterns

urlpatterns = format_suffix_patterns([
    paht('hello/', views.hello)
])
```
ìƒì„±ëœ URLPatternsëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
```txt
[
    <URLPatterns 'hello'/>,
    <URLPaatters 'hello<drf_format_suffix:format>'>
]
```









