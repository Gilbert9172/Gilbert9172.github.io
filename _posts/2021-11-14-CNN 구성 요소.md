---
layout: post
title: 합성곱 신경망의 구성 요소
categories: deeplearning
tags: cnn
---

### 💡 ***합성곱 신경망(Convolution Neural Network, CNN)***

> 1개 이상의 합성곱  층을 쓴 인공 신경망

입력 데이터 전체에 가중치를 적용하는 것이 아니라 일부에 가중치를 곱한다.

합성곱 층의 뉴런에 있는 가중치 개수는 정하기 나름이다. 

CNN에서는 뉴런을 <span style="color:#B8860B">**필터**</span> 혹은 <span style="color:#B8860B">**커널**</span>이라고 부른다.

보통 커널은 입력에 곱하는 가중치이고, 필터는 뉴런 개수를 표현할 때 사용된다.

합성곱의 장점은 1차원이 아니라 2차원 입력에도 적용할 수 있다는 점이다.

<img src="/assets/img/django/cnn1.png">

그리고 총 4번을 움직이기 때문에 4개의 값을 출력한다.

그리고 합성곱 계산을 통해 얻은 출력을 <span style="color:#BDB76B">**특성 맵(feature map)**</span>이라고 부른다.

일반적으로 특성 맵은 활성화 함수를 통과한 값을 나타낸다.

<img src="/assets/img/django/cnn2.png">

<br>

밀집층에서 여러 개의 뉴런을 사용하듯이 합성곱 층에서도 여러 개의 필터를 사용할 수 있다.

그리고 각 필터의 커널은 모두 다른 값을 가진다.

<img src="/assets/img/django/cnn3.png">

---

<br>

### 💡 ***Keras에서의 CNN***

합성곱 층은 <span style="color:#BDB76B">**Conv2D**</span> 클래스로 사용할 수 있다.

Conv2D 클래스의 매개변수는 3가지가 있다.

▪ 필터의 개수

▪ kernel_size : 보통 (3,3) or (5,5)

▪ activaion function

```python
from tensorflow import keras

keras.layers.Conv2D(10, kernel_size=(3,3), activation='relu')
```
---

<br>

### 💡 ***패딩과 스트라이드***

#### 패딩(Padding)

> 커널이 필터를 찍을 횟수를 늘려주기 위해서 입력 배열 주변을 가상의 원소로 채우는 것.

패딩의 역할은 순전히 커널이 필터를 찍을 횟수를 늘려주는 것밖에는 없다.

패딩은 실제 입력 값이 아니기 때문에 0으로 채워줘야 한다. 그리고 계산에

영향을 미치지 않는다.

아래의 그림처럼 입력과 특성 맵의 크기를 동일하게 만들기 위해 입력 주위에

0으로 패딩 하는 것을 <span style="color:#BDB76B">**Same Padding**</span>이라고 한다.

<img src="/assets/img/django/cnn4.png">

<br>

패딩 없이 순수한 입력 배열에서만 합성곱을 하여 특성맵을 만드는 경우를 <span style="color:#BDB76B">**Valid Padding**</span>이라고 한다.

