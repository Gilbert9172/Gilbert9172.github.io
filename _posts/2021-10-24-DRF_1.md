---
layout: post
title: DRF êµ¬í˜„
categories: django
tags: drf
---

### ğŸ’¡ Django ê¸°ë³¸ êµ¬í˜„ vs DRF êµ¬í˜„

ì˜¤ëŠ˜ì€ Django ê¸°ë³¸êµ¬í˜„ê³¼ DRFêµ¬í˜„ì˜ ì°¨ì´ì ì— ëŒ€í•´ì„œ ê³µë¶€í–ˆë‹¤.

ì²˜ìŒì— instagramì—ì„œ Postëª¨ë¸ì— ëŒ€í•œ APIë¥¼ ì„¤ê³„í•  ë•Œ ì•„ë˜ì™€ ê°™ì´ í–ˆì—ˆë‹¤.

ï¼‘. ìƒˆ í¬ìŠ¤íŒ… ë‚´ìš©ì„ ë°›ì•„ ë“±ë¡í•˜ê³ ,í™•ì¸ â‡¨ /post/new/ ; POSTìš”ì²­

ï¼’. í¬ìŠ¤íŒ… ëª©ë¡ ë° ê²€ìƒ‰ ì‘ë‹µ â‡¨ /post/ ; GETìš”ì²­

ï¼“. 1ë²ˆ í¬ìŠ¤íŒ… ë‚´ìš© ì‘ë‹µ â‡¨ /post/1/ ; GETìš”ì²­

ï¼”. 1ë²ˆ í¬ìŠ¤íŒ… ë‚´ìš© ê°±ì‹ í•˜ê³ , í™•ì¸ ì‘ë‹µ â‡¨ /post/1/update ; POSTìš”ì²­

ï¼•. 1ë²ˆ í¬ìŠ¤íŒ… ë‚´ìš© ì‚­ì„¸í•˜ê³ , í™•ì¸ ì‘ë‹µ â‡¨ /post/1/delete ; POSTìš”ì²­

<br>

REST API ìŠ¤íƒ€ì¼ë¡œ ì¬ì„¤ê³„ë¥¼ í•´ë³¸ë‹¤ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

ï¼‘. /post/ì£¼ì†Œ

- GET ë°©ì‹ ìš”ì²­ : ëª©ë¡ ì‘ë‹µ

- POST ë°©ì‹ ìš”ì²­ : ìƒˆ ê¸€ì„ ìƒì„±í•˜ê³  , í™•ì¸ ì‘ë‹µ

<br>

ï¼’. /post/10/ì£¼ì†Œ 

- GET ë°©ì‹ ìš”ì²­ : 10ë²ˆ ê¸€ ë‚´ìš© ì‘ë‹µ

- PUT ë°©ì‹ ìš”ì²­ : 10ë²ˆ ê¸€ ë‚´ìš© ìˆ˜ì •/ì €ì¥, í™•ì¸ ì‘ë‹µ

- DELETE  ë°©ì‹ ìš”ì²­ : 10ë²ˆ ê¸€ ì‚­ì œ, í™•ì¸ ì‘ë‹µ

<br>

```python
# models.py
class Post(models.Model):
    message = models.TextField()

# froms.py
class PostForm(forms.ModelForm):
    class Meta:
        model = Post
        fields = '__all__'

# views.py
def post_list(request):
    if request.method == "POST":
        # ìƒˆ ê¸€ ì €ì¥ì„ ìœ„í•œ êµ¬í˜„
        form = PostForm(request.POST, request.FILES)
        if form.is_valid:
            post = form.save()
            return JsonResponse(post)
        else:
            return JsonResponse(form.errors)
    else:
        # ëª©ë¡ ì‘ë‹µì„ ìœ„í•œ êµ¬í˜„(GET)
        return JsonResponse(Post.objects.all())

def post_detail(request):
    post_detail = Post.get_object_or_404(Post,pk=pk)
    if request.method == "PUT":
        # íŠ¹ì • ê¸€ ê°±ì‹ ì„ êµ¬í˜„
        put_data = Querydict(request.body)
        form = PostForm(put_data, instance=post)
        if form.is_valid:
            post = form.save()
            return JsonResponse(post)
        else:
            return JsonResponse(form.errors)
    elif request.method == "DELETE":
        # íŠ¹ì • ê¸€ ì‚­ì œë¥¼ êµ¬í˜„
        post.delete()
        return HttpResponse()
    else:
        # íŠ¹ì • ê¸€ ë‚´ìš© ì‘ë‹µì„ êµ¬í˜„ 
        return JsonResponse(post)
```

ìœ„ì˜ ì½”ë“œë¥¼ ë‹¤ë¥¸ ëª¨ë¸ì— ëŒ€í•´ì„œ ë™ì¼í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤ë©´,

Model/Formì„ ì œì™¸í•˜ê³ ëŠ” ê±°ì˜ ì •í˜•í™”ëœ íŒ¨í„´ì„ ë³´ì—¬ì¤€ë‹¤.

DRFëŠ” ì´ëŸ° ì •í˜•í™”ëœ ì¤‘ë³µì„ ì¤„ì¼ ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” CBVë¥¼ ë¹„ë¡¯í•˜ì—¬ 

ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì§€ì›í•´ì¤€ë‹¤. 

ìœ„ì˜ ì½”ë“œë¥¼ DRFë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì‹œ ì‘ì„±í•˜ê¸° ì „ì— djangorestframework ì„¤ì¹˜ë¥¼ í•´ì¤˜ì•¼ í•œë‹¤.

```shell
pip install djangorestframework
```
ì„¤ì¹˜ë¥¼ ì™„ë£Œ í–ˆìœ¼ë©´ `settings.INSTALLED_APPS`ì— `rest_framework`ë¥¼ ì¶”ê°€í•œë‹¤.

ê·¸ë¦¬ê³  urlpatternsì— ë‹¤ìŒ íŒ¨í„´ì„ ì¶”ê°€í•´ì¤€ë‹¤.

```python
# í”„ë¡œì íŠ¸ëª…/urls.py
urlpatterns = [
    path('api-auth', include('rest_framework.urls')
]
```

ì—¬ê¸°ì„œ include ì•ˆì— ìˆëŠ” <span style="color:#4682B4">**rest_framework**</span>ëŠ” ë‹¨ìˆœíˆ <span style="color:#4682B4">django.contrib.auth</span>ì˜

login, logoutì„ í™œìš©í•œ ê²ƒì´ë‹¤.

```python
from django.conf.urls import url 
from django.contrib.auth import views

app_name = 'rest_framework' 

urlpatterns = [
    url(r'^login/$', views.LoginView.as_view(template_name='rest_framework/login.html'), name='login'),
    url(r'^logout/$', views.LogoutView.as_view(), name='logout'),
]
```

ì´ì œ DRFë¡œ Postëª¨ë¸ì— ëŒ€í•œ APIë¥¼ ì„¤ê³„í•´ë³´ë©´, ì•„ë˜ì™€ ê°™ì´ í•  ìˆ˜ ìˆë‹¤.

```python
# models.py
class Post(models.Model):
    message = models.TextField()


# serializers.py
from rest_framework import serializers
from .models import Post

class PostSerializer(ModelSerializer):
    class Meta:
        model = Post
        fields = '__all__'


# views.py
from rest_framework import viewsets
from .seliarlizer import PostSerializer

class PostViewSet(ModelViewSet):
    queryset = Post.objects.all()
    serializer_class = PostSerializer


# urls.py
from rest_framework.routers import DefaultRouter
from . import views

router = DefaultRouter()

# 2ê°œì˜ URLì„ ë§Œë“¤ì–´ ì¤€ë‹¤.
# ìƒì„±ëœ "2ê°œì˜ URL"ì€  router.urlsì— listí˜•íƒœë¡œ ì¡´ì¬í•œë‹¤. 
router.register('posts', views.PostViewSet)

urlaptterns = [
    path('', include(routers.urls)),
]
```
êµ‰ì¥íˆ ì½”ë“œê°€ ê°„ê²°í•´ì¡Œë‹¤. 

Form/ModelForm â†’ Serializer/ModelSerializer

FBV/CBV â†’  FBV/CBV ê·¸ë¦¬ê³  ViewSet/ModelViewSet ë“±

<br>

ê·¸ë¦¬ê³  <span style="color:#4682B4">ursl.py</span> ë¶€ë¶„ì´ ì´í•´ê°€ ì˜ ì•ˆë˜ì„œ 

router.urlsë¥¼ ì¶œë ¥í•´ ë´¤ë”ë‹ˆ ì¶œë ¥ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.

```txt
[
    <URLPattern '^post/$' [name='post-list']>, 
    <URLPattern '^post\.(?P<format>[a-z0-9]+)/?$' [name='post-list']>,

    <URLPattern '^post/(?P<pk>[^/.]+)/$' [name='post-detail']>,
    <URLPattern '^post/(?P<pk>[^/.]+)\.(?P<format>[a-z0-9]+)/?$' [name='post-detail']>,

    <URLPattern '^$' [name='api-root']>,
    <URLPattern '^\.(?P<format>[a-z0-9]+)/?$' [name='api-root']>
]
```
---

<br>

<br>

### ğŸ“š References

- [Inflearn ê°•ì˜](https://www.inflearn.com/course/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EC%9E%A5%EA%B3%A0-%EC%9B%B9%EC%84%9C%EB%B9%84%EC%8A%A4/)

- [DRF Docs](https://www.django-rest-framework.org/api-guide/routers/#routers)